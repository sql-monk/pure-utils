{
    "sourceFile": "util/Functions/modulesRecureSearchStartEndPositionsExtended.sql",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1757955919238,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1757955919238,
            "name": "Commit-0",
            "content": "USE model; \r\nGO\r\nCREATE FUNCTION util.modulesRecureSearchStartEndPositionsExtended(@startValue NVARCHAR(32), @endValue NVARCHAR(32), @replaceCRwithLF BIT = 0, @objectID INT = NULL)\r\nRETURNS TABLE\r\nAS\r\nRETURN\r\n\t\t (WITH\tctestartEndRaw AS (\r\n\t\t\t\t SELECT\r\n\t\t\t\t\t 0 lvl,\r\n\t\t\t\t\t m.object_id,\r\n\t\t\t\t\t CHARINDEX(@startValue, IIF(@replaceCRwithLF = 1, REPLACE(m.definition, CHAR(13), CHAR(10)), m.definition)) startPosition,\r\n\t\t\t\t\t CONVERT(BIGINT, 0) endPosition,\r\n\t\t\t\t\t m.definition\r\n\t\t\t\t FROM sys.sql_modules(NOLOCK) m\r\n\t\t\t\t WHERE\r\n\t\t\t\t\t IIF(@replaceCRwithLF = 1, REPLACE(m.definition, CHAR(13), CHAR(10)), m.definition) LIKE '%' + @startValue + '%' + @endValue + '%'\r\n\t\t\t\t\t AND m.object_id = COALESCE(@objectID, m.object_id)\r\n\t\t\t\t UNION ALL\r\n\t\t\t\t SELECT\r\n\t\t\t\t\t m.lvl + 1,\r\n\t\t\t\t\t m.object_id,\r\n\t\t\t\t\t CHARINDEX(@startValue, m.definition, CHARINDEX(@endValue, m.definition, m.startPosition) + 1) startPosition, --start of next one\r\n\t\t\t\t\t CHARINDEX(@endValue, m.definition, m.startPosition + 1) endPosition, --end of prev!\r\n\t\t\t\t\t m.definition\r\n\t\t\t\t FROM ctestartEndRaw m\r\n\t\t\t\t WHERE\r\n\t\t\t\t\t m.startPosition <> 0 AND CHARINDEX(@endValue, m.definition, m.startPosition) <> 0\r\n\t\t\t ),\r\n\t\t\t ctestartEnd AS (SELECT ml.object_id, ml.startPosition, LEAD(ml.endPosition) OVER (PARTITION BY ml.object_id ORDER BY ml.lvl) endPosition FROM ctestartEndRaw ml)\r\n\t\t\t SELECT\r\n\t\t\t\t ctestartEnd.object_id, ctestartEnd.startPosition, ctestartEnd.endPosition\r\n\t\t\t FROM ctestartEnd\r\n\t\t\t WHERE\r\n\t\t\t\t ctestartEnd.startPosition > 0 AND ctestartEnd.endPosition > 0);\r\nGO\r\n\r\n"
        }
    ]
}