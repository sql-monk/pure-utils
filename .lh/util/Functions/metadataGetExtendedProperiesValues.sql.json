{
    "sourceFile": "util/Functions/metadataGetExtendedProperiesValues.sql",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 3,
            "patches": [
                {
                    "date": 1757961370472,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1757961523094,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -9,9 +9,9 @@\n \t\tep.name propertyName,\r\n \t\tCONVERT(NVARCHAR(MAX), ep.value) propertyValue,\r\n \t\tCASE\r\n \t\t\tWHEN ep.class = 1 AND ep.minor_id = 0 THEN util.metadataGetObjectType(ep.major_id)\r\n-\t\t\tELSE util.metadataGetAnyType(ep.class)\r\n+\t\t\tELSE util.metadataGetTypeName(ep.class)\r\n \t\tEND typeDesc\r\n \tFROM sys.extended_properties ep (NOLOCK)\r\n \t\tOUTER APPLY(SELECT o.type_desc FROM sys.objects o (NOLOCK) WHERE ep.major_id = o.object_id) objs\r\n \t\tOUTER APPLY(SELECT p.name FROM sys.parameters p (NOLOCK) WHERE ep.major_id = p.object_id AND ep.minor_id = p.parameter_id) params\r\n"
                },
                {
                    "date": 1757961588342,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -9,9 +9,9 @@\n \t\tep.name propertyName,\r\n \t\tCONVERT(NVARCHAR(MAX), ep.value) propertyValue,\r\n \t\tCASE\r\n \t\t\tWHEN ep.class = 1 AND ep.minor_id = 0 THEN util.metadataGetObjectType(ep.major_id)\r\n-\t\t\tELSE util.metadataGetTypeName(ep.class)\r\n+\t\t\tELSE util.metadataGetClassName(ep.class)\r\n \t\tEND typeDesc\r\n \tFROM sys.extended_properties ep (NOLOCK)\r\n \t\tOUTER APPLY(SELECT o.type_desc FROM sys.objects o (NOLOCK) WHERE ep.major_id = o.object_id) objs\r\n \t\tOUTER APPLY(SELECT p.name FROM sys.parameters p (NOLOCK) WHERE ep.major_id = p.object_id AND ep.minor_id = p.parameter_id) params\r\n"
                },
                {
                    "date": 1757963005460,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -8,13 +8,13 @@\n \t\tutil.metadataGetAnyName(ep.major_id, ep.minor_id, ep.class) name,\r\n \t\tep.name propertyName,\r\n \t\tCONVERT(NVARCHAR(MAX), ep.value) propertyValue,\r\n \t\tCASE\r\n-\t\t\tWHEN ep.class = 1 AND ep.minor_id = 0 THEN util.metadataGetObjectType(ep.major_id)\r\n+\t\t\tWHEN ep.class = 1 AND ep.minor_id = 0 THEN objs.objectType\r\n \t\t\tELSE util.metadataGetClassName(ep.class)\r\n \t\tEND typeDesc\r\n \tFROM sys.extended_properties ep (NOLOCK)\r\n-\t\tOUTER APPLY(SELECT o.type_desc FROM sys.objects o (NOLOCK) WHERE ep.major_id = o.object_id) objs\r\n+\t\tOUTER APPLY metadataGetObjectsType(ep.major_id) objs\r\n \t\tOUTER APPLY(SELECT p.name FROM sys.parameters p (NOLOCK) WHERE ep.major_id = p.object_id AND ep.minor_id = p.parameter_id) params\r\n \t\tOUTER APPLY(SELECT c.name FROM sys.columns c (NOLOCK) WHERE ep.major_id = c.object_id AND ep.minor_id = c.column_id) cols\r\n \t\tOUTER APPLY(SELECT ix.name FROM sys.indexes ix (NOLOCK) WHERE ep.major_id = ix.object_id AND ep.minor_id = ix.index_id) idx\r\n \t\tOUTER APPLY(SELECT pf.name FROM sys.partition_functions pf (NOLOCK) WHERE ep.major_id = pf.function_id) partfunc\r\n"
                }
            ],
            "date": 1757961370472,
            "name": "Commit-0",
            "content": "CREATE FUNCTION [util].[metadataGetExtendedProperiesValues](@majorId INT = NULL, @minorId SMALLINT = NULL, @property NVARCHAR(128) = NULL)\r\nRETURNS TABLE\r\nAS\r\nRETURN(\r\n\tSELECT\r\n\t\tep.major_id Id,\r\n\t\tep.class,\r\n\t\tutil.metadataGetAnyName(ep.major_id, ep.minor_id, ep.class) name,\r\n\t\tep.name propertyName,\r\n\t\tCONVERT(NVARCHAR(MAX), ep.value) propertyValue,\r\n\t\tCASE\r\n\t\t\tWHEN ep.class = 1 AND ep.minor_id = 0 THEN util.metadataGetObjectType(ep.major_id)\r\n\t\t\tELSE util.metadataGetAnyType(ep.class)\r\n\t\tEND typeDesc\r\n\tFROM sys.extended_properties ep (NOLOCK)\r\n\t\tOUTER APPLY(SELECT o.type_desc FROM sys.objects o (NOLOCK) WHERE ep.major_id = o.object_id) objs\r\n\t\tOUTER APPLY(SELECT p.name FROM sys.parameters p (NOLOCK) WHERE ep.major_id = p.object_id AND ep.minor_id = p.parameter_id) params\r\n\t\tOUTER APPLY(SELECT c.name FROM sys.columns c (NOLOCK) WHERE ep.major_id = c.object_id AND ep.minor_id = c.column_id) cols\r\n\t\tOUTER APPLY(SELECT ix.name FROM sys.indexes ix (NOLOCK) WHERE ep.major_id = ix.object_id AND ep.minor_id = ix.index_id) idx\r\n\t\tOUTER APPLY(SELECT pf.name FROM sys.partition_functions pf (NOLOCK) WHERE ep.major_id = pf.function_id) partfunc\r\n\tWHERE ISNULL(@majorId, ep.major_id) = ep.major_id \r\n\t\tAND ISNULL(@minorId, ep.minor_id) = ep.minor_id\r\n\t\tAND ISNULL(@property, ep.name) = ep.name\r\n);"
        }
    ]
}