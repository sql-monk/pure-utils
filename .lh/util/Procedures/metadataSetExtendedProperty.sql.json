{
    "sourceFile": "util/Procedures/metadataSetExtendedProperty.sql",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 4,
            "patches": [
                {
                    "date": 1757964521480,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1757964532322,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -16,9 +16,9 @@\n \r\n \t-- Перевірка на існування extended property\r\n \tIF NOT EXISTS (\r\n \t\tSELECT * \r\n-\t\tFROM sys.extended_properties (NOLOCK) \r\n+\t\tFROM sys.extended_properties\r\n \t\tWHERE name = @name \r\n \t\t\tAND ISNULL(@level0type, 'DATABASE') = 'DATABASE'\r\n \t\t\tAND ISNULL(@level1type, '') = ISNULL(@level1type, '')\r\n \t\t\tAND ISNULL(@level1name, '') = ISNULL(@level1name, '')\r\n"
                },
                {
                    "date": 1757964849609,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,20 +1,18 @@\n-USE model; \r\n-GO\r\n CREATE OR ALTER PROCEDURE [util].[metadataSetExtendedProperty]\r\n \t@name NVARCHAR(128),\r\n-\t@value sql_variant = NULL,\r\n-\t@level0type VARCHAR(128) = NULL,\r\n+\t@value NVARCHAR(max) = NULL,\r\n+\t@level0type NVARCHAR(128) = NULL,\r\n \t@level0name NVARCHAR(128) = NULL,\r\n-\t@level1type VARCHAR(128) = NULL,\r\n+\t@level1type NVARCHAR(128) = NULL,\r\n \t@level1name NVARCHAR(128) = NULL,\r\n-\t@level2type VARCHAR(128) = NULL,\r\n+\t@level2type NVARCHAR(128) = NULL,\r\n \t@level2name NVARCHAR(128) = NULL\r\n AS\r\n BEGIN\r\n \tSET NOCOUNT ON;\r\n \tSET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;\r\n-\r\n+\tDECLARE @varVal VARCHAR(max) = @value\r\n \t-- Перевірка на існування extended property\r\n \tIF NOT EXISTS (\r\n \t\tSELECT * \r\n \t\tFROM sys.extended_properties\r\n@@ -28,9 +26,9 @@\n \tBEGIN\r\n \t\t-- Додавання нового extended property\r\n \t\tEXEC sys.sp_addextendedproperty\r\n \t\t\t@name = @name,\r\n-\t\t\t@value = @value,\r\n+\t\t\t@value = @varVal,\r\n \t\t\t@level0type = @level0type,\r\n \t\t\t@level0name = @level0name,\r\n \t\t\t@level1type = @level1type,\r\n \t\t\t@level1name = @level1name,\r\n@@ -41,14 +39,13 @@\n \tBEGIN\r\n \t\t-- Оновлення існуючого extended property\r\n \t\tEXEC sys.sp_updateextendedproperty\r\n \t\t\t@name = @name,\r\n-\t\t\t@value = @value,\r\n+\t\t\t@value = @varVal,\r\n \t\t\t@level0type = @level0type,\r\n \t\t\t@level0name = @level0name,\r\n \t\t\t@level1type = @level1type,\r\n \t\t\t@level1name = @level1name,\r\n \t\t\t@level2type = @level2type,\r\n \t\t\t@level2name = @level2name;\r\n \tEND\r\n END;\r\n\\ No newline at end of file\n-GO\n"
                },
                {
                    "date": 1757964856235,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,5 +1,5 @@\n-CREATE OR ALTER PROCEDURE [util].[metadataSetExtendedProperty]\r\n+CREATE PROCEDURE [util].[metadataSetExtendedProperty]\r\n \t@name NVARCHAR(128),\r\n \t@value NVARCHAR(max) = NULL,\r\n \t@level0type NVARCHAR(128) = NULL,\r\n \t@level0name NVARCHAR(128) = NULL,\r\n@@ -47,5 +47,5 @@\n \t\t\t@level1name = @level1name,\r\n \t\t\t@level2type = @level2type,\r\n \t\t\t@level2name = @level2name;\r\n \tEND\r\n-END;\n\\ No newline at end of file\n+END;\r\n"
                },
                {
                    "date": 1757964946488,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,5 +1,5 @@\n-CREATE PROCEDURE [util].[metadataSetExtendedProperty]\r\n+CREATE OR ALTER PROCEDURE [util].[metadataSetExtendedProperty]\r\n \t@name NVARCHAR(128),\r\n \t@value NVARCHAR(max) = NULL,\r\n \t@level0type NVARCHAR(128) = NULL,\r\n \t@level0name NVARCHAR(128) = NULL,\r\n@@ -10,9 +10,9 @@\n AS\r\n BEGIN\r\n \tSET NOCOUNT ON;\r\n \tSET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;\r\n-\tDECLARE @varVal VARCHAR(max) = @value\r\n+\tDECLARE @varVal VARCHAR(4000) = @value\r\n \t-- Перевірка на існування extended property\r\n \tIF NOT EXISTS (\r\n \t\tSELECT * \r\n \t\tFROM sys.extended_properties\r\n@@ -48,4 +48,5 @@\n \t\t\t@level2type = @level2type,\r\n \t\t\t@level2name = @level2name;\r\n \tEND\r\n END;\r\n+GO\n\\ No newline at end of file\n"
                }
            ],
            "date": 1757964521480,
            "name": "Commit-0",
            "content": "USE model; \r\nGO\r\nCREATE OR ALTER PROCEDURE [util].[metadataSetExtendedProperty]\r\n\t@name NVARCHAR(128),\r\n\t@value sql_variant = NULL,\r\n\t@level0type VARCHAR(128) = NULL,\r\n\t@level0name NVARCHAR(128) = NULL,\r\n\t@level1type VARCHAR(128) = NULL,\r\n\t@level1name NVARCHAR(128) = NULL,\r\n\t@level2type VARCHAR(128) = NULL,\r\n\t@level2name NVARCHAR(128) = NULL\r\nAS\r\nBEGIN\r\n\tSET NOCOUNT ON;\r\n\tSET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;\r\n\r\n\t-- Перевірка на існування extended property\r\n\tIF NOT EXISTS (\r\n\t\tSELECT * \r\n\t\tFROM sys.extended_properties (NOLOCK) \r\n\t\tWHERE name = @name \r\n\t\t\tAND ISNULL(@level0type, 'DATABASE') = 'DATABASE'\r\n\t\t\tAND ISNULL(@level1type, '') = ISNULL(@level1type, '')\r\n\t\t\tAND ISNULL(@level1name, '') = ISNULL(@level1name, '')\r\n\t\t\tAND ISNULL(@level2type, '') = ISNULL(@level2type, '')\r\n\t\t\tAND ISNULL(@level2name, '') = ISNULL(@level2name, '')\r\n\t)\r\n\tBEGIN\r\n\t\t-- Додавання нового extended property\r\n\t\tEXEC sys.sp_addextendedproperty\r\n\t\t\t@name = @name,\r\n\t\t\t@value = @value,\r\n\t\t\t@level0type = @level0type,\r\n\t\t\t@level0name = @level0name,\r\n\t\t\t@level1type = @level1type,\r\n\t\t\t@level1name = @level1name,\r\n\t\t\t@level2type = @level2type,\r\n\t\t\t@level2name = @level2name;\r\n\tEND\r\n\tELSE\r\n\tBEGIN\r\n\t\t-- Оновлення існуючого extended property\r\n\t\tEXEC sys.sp_updateextendedproperty\r\n\t\t\t@name = @name,\r\n\t\t\t@value = @value,\r\n\t\t\t@level0type = @level0type,\r\n\t\t\t@level0name = @level0name,\r\n\t\t\t@level1type = @level1type,\r\n\t\t\t@level1name = @level1name,\r\n\t\t\t@level2type = @level2type,\r\n\t\t\t@level2name = @level2name;\r\n\tEND\r\nEND;\r\nGO"
        }
    ]
}